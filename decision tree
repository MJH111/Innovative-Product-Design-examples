import pandas as pd
from sklearn import tree
from sklearn.model_selection import train_test_split
from sklearn.tree import export_text
import matplotlib.pyplot as plt
import joblib
import numpy as np

data = pd.read_csv('posture_training_data.csv')

# 把資料分成驗證及訓練資料
# Splitting the dataset into  training and validation sets
X = data.iloc[:, 0:29]
Y = data.iloc[:, 30]
label = ['lay','sit','edgeL','edgeR','empty']

train_X, test_X, train_y, test_y = train_test_split(X, Y, test_size = 0.1)

# 建立模型
# Importing MLPClassifier
clf = tree.DecisionTreeClassifier()# max_depth = 5


# 開始訓練
# Fitting the training data to the network
clf = clf.fit(train_X, train_y)

# Predicting y for X_val
y_pred = clf.predict(test_X)

r = export_text(clf)
# print(r)

plt.figure(figsize=(28, 20))#, dpi=300
tree.plot_tree(clf, filled=True)#, fontsize=
# plt.savefig("tree.png", dpi=100)
plt.show()
# print(y_pred)
# print(test_y)
